scripted_gui = {
    colonize_button = {
        window_name = "province_colonize_window"
        parent_window_token = selected_state_view
        context_type = selected_state_context

        visible = {
            always = yes
        }

        triggers = {
            colonize_button_visible = {
                has_state_flag = tribe_state
                is_owned_by = TRB
                OR = {
                    # needs fix as province definition is wrong
                    is_coastal = yes
                    num_owned_neighbour_states = {
                        owner = ROOT
                        count > 0
                    }
                }
            }
        }

        effects = {
            colonize_button_click = {
                # check if can be colonized
                if = {
        			limit = {
                        NOT = {
                            ROOT = {
                                #has_country_flag = is_colonizing
                                is_ai = yes
                            }
                        }
                        has_state_flag = tribe_state
        				OR = {
                            AND = {
                                is_coastal = no
                                num_owned_neighbour_states = {
                                    owner = ROOT
                                    count > 0
                                }
                            }
                            AND = {
                                is_coastal = yes
                                if = {
                                    limit = {
                                        is_owned_by = ROOT
                                    }
                                    distance_to = {
                                        value < 75
                                        target = PREV
                                    }
                                }
                            }
        				}
        			}
                    # calculate time
                    set_variable = { ROOT.colonial_time = 50 }
                    set_variable = { ROOT.temp_population = state_population_k }
				    divide_variable = { ROOT.temp_population = 50 }
                    add_to_variable = { ROOT.temp_population = 1 }

                    multiply_variable = {
                        var = ROOT.colonial_time
                        value = ROOT.temp_population
                    }

                    # malaria
                    # not has tech
                    #multiply_variable = {
                    #    var = ROOT.colonial_time
                    #    value = 9
                    #}

                    multiply_variable = {
                        var = ROOT.colonial_time
                        value = ROOT.extra_colonizing_speed
                    }

                    # DEBUG, to be removed
                    set_variable = { ROOT.colonial_time = 1 }
			
				    set_state_flag = colonizing_by_@ROOT

                    #set_variable = { THIS.integration_time = ROOT.colonial_time }
                    
                    # start colonization
                    
                    ROOT = {
                        activate_targeted_decision = {
                            target = PREV
                            decision = colonization_descision
                        }
                        set_country_flag = is_colonizing
                    }
                    #log = "Activated via button"
        		}
            }
        }

        ai_enabled = {
            always = no
            #is_historical_focus_on = yes
        }

        ai_test_interval = 290  # The higher, the long it takes the ai to do actions
        ai_test_variance = 0.5
    }
}